<!--  -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISBN Canvas Roaming with Country/Language Highlight</title>
    <style>
        body { margin: 0; }
        #mainCanvas {
            position: absolute;
            z-index: 1;
            cursor: grab;
        }
        #overlayCanvas {
            position: absolute;
            z-index: 2;
            pointer-events: none; /* Prevent interaction with the overlay canvas */
        }
    </style>
</head>
<body>
    <canvas id="mainCanvas" width="1000" height="800"></canvas>
    <canvas id="overlayCanvas" width="1000" height="800"></canvas>

    <script>
        const mainCanvas = document.getElementById('mainCanvas');
        const overlayCanvas = document.getElementById('overlayCanvas');
        const ctx = mainCanvas.getContext('2d');
        const overlayCtx = overlayCanvas.getContext('2d');

        const canvasWidth = 1000;
        const canvasHeight = 800;
        const imageWidth = 5000;
        const imageHeight = 4000;

        const isbnPerPixel = 100;  // 100 ISBNs per pixel
        let offsetX = 0, offsetY = 0;

        let imageData = new Image();
        imageData.src = './all_isbns_smaller10x.png'; // Your image source

        let dragging = false;
        let startX, startY;

        const countries = {
"978-0": "English language ğŸ‡¬ğŸ‡§ğŸ‡ºğŸ‡¸ğŸ‡¨ğŸ‡¦ğŸ‡¦ğŸ‡ºğŸ‡³ğŸ‡¿ğŸ‡¿ğŸ‡¦",
"978-1": "English language ğŸ‡¬ğŸ‡§ğŸ‡ºğŸ‡¸ğŸ‡¨ğŸ‡¦ğŸ‡¦ğŸ‡ºğŸ‡³ğŸ‡¿ğŸ‡¿ğŸ‡¦",
"978-2": "French language ğŸ‡«ğŸ‡·ğŸ‡¨ğŸ‡¦ğŸ‡§ğŸ‡ªğŸ‡¨ğŸ‡­ğŸ‡±ğŸ‡ºğŸ‡§ğŸ‡®",
"978-3": "German language ğŸ‡©ğŸ‡ªğŸ‡¦ğŸ‡¹ğŸ‡¨ğŸ‡­",
"978-4": "Japan ğŸ‡¯ğŸ‡µ",
"978-5": "former U.S.S.R",
"978-600": "Iran ğŸ‡®ğŸ‡·",
"978-601": "Kazakhstan ğŸ‡°ğŸ‡¿",
"978-602": "Indonesia ğŸ‡®ğŸ‡©",
"978-603": "Saudi Arabia ğŸ‡¸ğŸ‡¦",
"978-604": "Vietnam ğŸ‡»ğŸ‡³",
"978-605": "Turkey ğŸ‡¹ğŸ‡·",
"978-606": "Romania ğŸ‡·ğŸ‡´",
"978-607": "Mexico ğŸ‡²ğŸ‡½",
"978-608": "North Macedonia ğŸ‡²ğŸ‡°",
"978-609": "Lithuania ğŸ‡±ğŸ‡¹",
"978-611": "Thailand ğŸ‡¹ğŸ‡­",
"978-612": "Peru ğŸ‡µğŸ‡ª",
"978-613": "Mauritius ğŸ‡²ğŸ‡º",
"978-614": "Lebanon ğŸ‡±ğŸ‡§",
"978-615": "Hungary ğŸ‡­ğŸ‡º",
"978-616": "Thailand ğŸ‡¹ğŸ‡­",
"978-617": "Ukraine ğŸ‡ºğŸ‡¦",
"978-618": "Greece ğŸ‡¬ğŸ‡·",
"978-619": "Bulgaria ğŸ‡§ğŸ‡¬",
"978-620": "Mauritius ğŸ‡²ğŸ‡º",
"978-621": "Philippines ğŸ‡µğŸ‡­",
"978-622": "Iran ğŸ‡®ğŸ‡·",
"978-623": "Indonesia ğŸ‡®ğŸ‡©",
"978-624": "Sri Lanka ğŸ‡±ğŸ‡°",
"978-625": "Turkey ğŸ‡¹ğŸ‡·",
"978-626": "Taiwan ğŸ‡¹ğŸ‡¼",
"978-627": "Pakistan ğŸ‡µğŸ‡°",
"978-628": "Colombia ğŸ‡¨ğŸ‡´",
"978-629": "Malaysia ğŸ‡²ğŸ‡¾",
"978-630": "Romania ğŸ‡·ğŸ‡´",
"978-631": "Argentina ğŸ‡¦ğŸ‡·",
"978-65": "Brazil ğŸ‡§ğŸ‡·",
"978-7": "China, People's Republic ğŸ‡¨ğŸ‡³",
"978-80": "former Czechoslovakia ğŸ‡¨ğŸ‡¿ğŸ‡¸ğŸ‡°",
"978-81": "India ğŸ‡®ğŸ‡³",
"978-82": "Norway ğŸ‡³ğŸ‡´",
"978-83": "Poland ğŸ‡µğŸ‡±",
"978-84": "Spain ğŸ‡ªğŸ‡¸",
"978-85": "Brazil ğŸ‡§ğŸ‡·",
"978-86": "former Yugoslavia ğŸ‡·ğŸ‡¸",
"978-87": "Denmark ğŸ‡©ğŸ‡°",
"978-88": "Italy ğŸ‡®ğŸ‡¹",
"978-89": "Korea, Republic ğŸ‡°ğŸ‡·",
"978-90": "Netherlands ğŸ‡³ğŸ‡±",
"978-91": "Sweden ğŸ‡¸ğŸ‡ª",
"978-92": "International NGO Publishers and EU Organizations ğŸ‡ªğŸ‡º",
"978-93": "India ğŸ‡®ğŸ‡³",
"978-94": "Netherlands ğŸ‡³ğŸ‡±",
"978-950": "Argentina ğŸ‡¦ğŸ‡·",
"978-951": "Finland ğŸ‡«ğŸ‡®",
"978-952": "Finland ğŸ‡«ğŸ‡®",
"978-953": "Croatia ğŸ‡­ğŸ‡·",
"978-954": "Bulgaria ğŸ‡§ğŸ‡¬",
"978-955": "Sri Lanka ğŸ‡±ğŸ‡°",
"978-956": "Chile ğŸ‡¨ğŸ‡±",
"978-957": "Taiwan ğŸ‡¹ğŸ‡¼",
"978-958": "Colombia ğŸ‡¨ğŸ‡´",
"978-959": "Cuba ğŸ‡¨ğŸ‡º",
"978-960": "Greece ğŸ‡¬ğŸ‡·",
"978-961": "Slovenia ğŸ‡¸ğŸ‡®",
"978-962": "Hong Kong ğŸ‡­ğŸ‡°",
"978-963": "Hungary ğŸ‡­ğŸ‡º",
"978-964": "Iran ğŸ‡®ğŸ‡·",
"978-965": "Israel ğŸ‡®ğŸ‡±",
"978-966": "Ukraine ğŸ‡ºğŸ‡¦",
"978-967": "Malaysia ğŸ‡²ğŸ‡¾",
"978-968": "Mexico ğŸ‡²ğŸ‡½",
"978-969": "Pakistan ğŸ‡µğŸ‡°",
"978-970": "Mexico ğŸ‡²ğŸ‡½",
"978-971": "Philippines ğŸ‡µğŸ‡­",
"978-972": "Portugal ğŸ‡µğŸ‡¹",
"978-973": "Romania ğŸ‡·ğŸ‡´",
"978-974": "Thailand ğŸ‡¹ğŸ‡­",
"978-975": "Turkey ğŸ‡¹ğŸ‡·",
"978-976": "Caribbean Community ğŸ‡§ğŸ‡§ğŸ‡§ğŸ‡¸",
"978-977": "Egypt ğŸ‡ªğŸ‡¬",
"978-978": "Nigeria ğŸ‡³ğŸ‡¬",
"978-979": "Indonesia ğŸ‡®ğŸ‡©",
"978-980": "Venezuela ğŸ‡»ğŸ‡ª",
"978-981": "Singapore ğŸ‡¸ğŸ‡¬",
"978-982": "South Pacific ğŸ‡µğŸ‡¬",
"978-983": "Malaysia ğŸ‡²ğŸ‡¾",
"978-984": "Bangladesh ğŸ‡§ğŸ‡©",
"978-985": "Belarus ğŸ‡§ğŸ‡¾",
"978-986": "Taiwan ğŸ‡¹ğŸ‡¼",
"978-987": "Argentina ğŸ‡¦ğŸ‡·",
"978-988": "Hong Kong ğŸ‡­ğŸ‡°",
"978-989": "Portugal ğŸ‡µğŸ‡¹",
"978-9910": "Uzbekistan ğŸ‡ºğŸ‡¿",
"978-9911": "Montenegro ğŸ‡²ğŸ‡ª",
"978-9912": "Tanzania ğŸ‡¹ğŸ‡¿",
"978-9913": "Uganda ğŸ‡ºğŸ‡¬",
"978-9914": "Kenya ğŸ‡°ğŸ‡ª",
"978-9915": "Uruguay ğŸ‡ºğŸ‡¾",
"978-9916": "Estonia ğŸ‡ªğŸ‡ª",
"978-9917": "Bolivia ğŸ‡§ğŸ‡´",
"978-9918": "Malta ğŸ‡²ğŸ‡¹",
"978-9919": "Mongolia ğŸ‡²ğŸ‡³",
"978-9920": "Morocco ğŸ‡²ğŸ‡¦",
"978-9921": "Kuwait ğŸ‡°ğŸ‡¼",
"978-9922": "Iraq ğŸ‡®ğŸ‡¶",
"978-9923": "Jordan ğŸ‡¯ğŸ‡´",
"978-9924": "Cambodia ğŸ‡°ğŸ‡­",
"978-9925": "Cyprus ğŸ‡¨ğŸ‡¾",
"978-9926": "Bosnia and Herzegovina ğŸ‡§ğŸ‡¦",
"978-9927": "Qatar ğŸ‡¶ğŸ‡¦",
"978-9928": "Albania ğŸ‡¦ğŸ‡±",
"978-9929": "Guatemala ğŸ‡¬ğŸ‡¹",
"978-9930": "Costa Rica ğŸ‡¨ğŸ‡·",
"978-9931": "Algeria ğŸ‡©ğŸ‡¿",
"978-9932": "Lao People's Democratic Republic ğŸ‡±ğŸ‡¦",
"978-9933": "Syria ğŸ‡¸ğŸ‡¾",
"978-9934": "Latvia ğŸ‡±ğŸ‡»",
"978-9935": "Iceland ğŸ‡®ğŸ‡¸",
"978-9936": "Afghanistan ğŸ‡¦ğŸ‡«",
"978-9937": "Nepal ğŸ‡³ğŸ‡µ",
"978-9938": "Tunisia ğŸ‡¹ğŸ‡³",
"978-9939": "Armenia ğŸ‡¦ğŸ‡²",
"978-9940": "Montenegro ğŸ‡²ğŸ‡ª",
"978-9941": "Georgia ğŸ‡¬ğŸ‡ª",
"978-9942": "Ecuador ğŸ‡ªğŸ‡¨",
"978-9943": "Uzbekistan ğŸ‡ºğŸ‡¿",
"978-9944": "Turkey ğŸ‡¹ğŸ‡·",
"978-9945": "Dominican Republic ğŸ‡©ğŸ‡´",
"978-9946": "Korea, P.D.R. ğŸ‡°ğŸ‡µ",
"978-9947": "Algeria ğŸ‡©ğŸ‡¿",
"978-9948": "United Arab Emirates ğŸ‡¦ğŸ‡ª",
"978-9949": "Estonia ğŸ‡ªğŸ‡ª",
"978-9950": "Palestine ğŸ‡µğŸ‡¸",
"978-9951": "Kosova ğŸ‡½ğŸ‡°",
"978-9952": "Azerbaijan ğŸ‡¦ğŸ‡¿",
"978-9953": "Lebanon ğŸ‡±ğŸ‡§",
"978-9954": "Morocco ğŸ‡²ğŸ‡¦",
"978-9955": "Lithuania ğŸ‡±ğŸ‡¹",
"978-9956": "Cameroon ğŸ‡¨ğŸ‡²",
"978-9957": "Jordan ğŸ‡¯ğŸ‡´",
"978-9958": "Bosnia and Herzegovina ğŸ‡§ğŸ‡¦",
"978-9959": "Libya ğŸ‡±ğŸ‡¾",
"978-9960": "Saudi Arabia ğŸ‡¸ğŸ‡¦",
"978-9961": "Algeria ğŸ‡©ğŸ‡¿",
"978-9962": "Panama ğŸ‡µğŸ‡¦",
"978-9963": "Cyprus ğŸ‡¨ğŸ‡¾",
"978-9964": "Ghana ğŸ‡¬ğŸ‡­",
"978-9965": "Kazakhstan ğŸ‡°ğŸ‡¿",
"978-9966": "Kenya ğŸ‡°ğŸ‡ª",
"978-9967": "Kyrgyz Republic ğŸ‡°ğŸ‡¬",
"978-9968": "Costa Rica ğŸ‡¨ğŸ‡·",
"978-9969": "Algeria ğŸ‡©ğŸ‡¿",
"978-9970": "Uganda ğŸ‡ºğŸ‡¬",
"978-9971": "Singapore ğŸ‡¸ğŸ‡¬",
"978-9972": "Peru ğŸ‡µğŸ‡ª",
"978-9973": "Tunisia ğŸ‡¹ğŸ‡³",
"978-9974": "Uruguay ğŸ‡ºğŸ‡¾",
"978-9975": "Moldova ğŸ‡²ğŸ‡©",
"978-9976": "Tanzania ğŸ‡¹ğŸ‡¿",
"978-9977": "Costa Rica ğŸ‡¨ğŸ‡·",
"978-9978": "Ecuador ğŸ‡ªğŸ‡¨",
"978-9979": "Iceland ğŸ‡®ğŸ‡¸",
"978-9980": "Papua New Guinea ğŸ‡µğŸ‡¬",
"978-9981": "Morocco ğŸ‡²ğŸ‡¦",
"978-9982": "Zambia ğŸ‡¿ğŸ‡²",
"978-9983": "Gambia ğŸ‡¬ğŸ‡²",
"978-9984": "Latvia ğŸ‡±ğŸ‡»",
"978-9985": "Estonia ğŸ‡ªğŸ‡ª",
"978-9986": "Lithuania ğŸ‡±ğŸ‡¹",
"978-9987": "Tanzania ğŸ‡¹ğŸ‡¿",
"978-9988": "Ghana ğŸ‡¬ğŸ‡­",
"978-9989": "North Macedonia ğŸ‡²ğŸ‡°",
"978-99901": "Bahrain ğŸ‡§ğŸ‡­",
"978-99902": "Reserved Agency",
"978-99903": "Mauritius ğŸ‡²ğŸ‡º",
"978-99904": "CuraÃ§ao ğŸ‡¨ğŸ‡¼",
"978-99905": "Bolivia ğŸ‡§ğŸ‡´",
"978-99906": "Kuwait ğŸ‡°ğŸ‡¼",
"978-99908": "Malawi ğŸ‡²ğŸ‡¼",
"978-99909": "Malta ğŸ‡²ğŸ‡¹",
"978-99910": "Sierra Leone ğŸ‡¸ğŸ‡±",
"978-99911": "Lesotho ğŸ‡±ğŸ‡¸",
"978-99912": "Botswana ğŸ‡§ğŸ‡¼",
"978-99913": "Andorra ğŸ‡¦ğŸ‡©",
"978-99914": "International NGO Publishers",
"978-99915": "Maldives ğŸ‡²ğŸ‡»",
"978-99916": "Namibia ğŸ‡³ğŸ‡¦",
"978-99917": "Brunei Darussalam ğŸ‡§ğŸ‡³",
"978-99918": "Faroe Islands ğŸ‡«ğŸ‡´",
"978-99919": "Benin ğŸ‡§ğŸ‡¯",
"978-99920": "Andorra ğŸ‡¦ğŸ‡©",
"978-99921": "Qatar ğŸ‡¶ğŸ‡¦",
"978-99922": "Guatemala ğŸ‡¬ğŸ‡¹",
"978-99923": "El Salvador ğŸ‡¸ğŸ‡»",
"978-99924": "Nicaragua ğŸ‡³ğŸ‡®",
"978-99925": "Paraguay ğŸ‡µğŸ‡¾",
"978-99926": "Honduras ğŸ‡­ğŸ‡³",
"978-99927": "Albania ğŸ‡¦ğŸ‡±",
"978-99928": "Georgia ğŸ‡¬ğŸ‡ª",
"978-99929": "Mongolia ğŸ‡²ğŸ‡³",
"978-99930": "Armenia ğŸ‡¦ğŸ‡²",
"978-99931": "Seychelles ğŸ‡¸ğŸ‡¨",
"978-99932": "Malta ğŸ‡²ğŸ‡¹",
"978-99933": "Nepal ğŸ‡³ğŸ‡µ",
"978-99934": "Dominican Republic ğŸ‡©ğŸ‡´",
"978-99935": "Haiti ğŸ‡­ğŸ‡¹",
"978-99936": "Bhutan ğŸ‡§ğŸ‡¹",
"978-99937": "Macau ğŸ‡²ğŸ‡´",
"978-99938": "Srpska, Republic of ğŸ‡·ğŸ‡¸",
"978-99939": "Guatemala ğŸ‡¬ğŸ‡¹",
"978-99940": "Georgia ğŸ‡¬ğŸ‡ª",
"978-99941": "Armenia ğŸ‡¦ğŸ‡²",
"978-99942": "Sudan ğŸ‡¸ğŸ‡©",
"978-99943": "Albania ğŸ‡¦ğŸ‡±",
"978-99944": "Ethiopia ğŸ‡ªğŸ‡¹",
"978-99945": "Namibia ğŸ‡³ğŸ‡¦",
"978-99946": "Nepal ğŸ‡³ğŸ‡µ",
"978-99947": "Tajikistan ğŸ‡¹ğŸ‡¯",
"978-99948": "Eritrea ğŸ‡ªğŸ‡·",
"978-99949": "Mauritius ğŸ‡²ğŸ‡º",
"978-99950": "Cambodia ğŸ‡°ğŸ‡­",
"978-99951": "Reserved Agency",
"978-99952": "Mali ğŸ‡²ğŸ‡±",
"978-99953": "Paraguay ğŸ‡µğŸ‡¾",
"978-99954": "Bolivia ğŸ‡§ğŸ‡´",
"978-99955": "Srpska, Republic of ğŸ‡·ğŸ‡¸",
"978-99956": "Albania ğŸ‡¦ğŸ‡±",
"978-99957": "Malta ğŸ‡²ğŸ‡¹",
"978-99958": "Bahrain ğŸ‡§ğŸ‡­",
"978-99959": "Luxembourg ğŸ‡±ğŸ‡º",
"978-99960": "Malawi ğŸ‡²ğŸ‡¼",
"978-99961": "El Salvador ğŸ‡¸ğŸ‡»",
"978-99962": "Mongolia ğŸ‡²ğŸ‡³",
"978-99963": "Cambodia ğŸ‡°ğŸ‡­",
"978-99964": "Nicaragua ğŸ‡³ğŸ‡®",
"978-99965": "Macau ğŸ‡²ğŸ‡´",
"978-99966": "Kuwait ğŸ‡°ğŸ‡¼",
"978-99967": "Paraguay ğŸ‡µğŸ‡¾",
"978-99968": "Botswana ğŸ‡§ğŸ‡¼",
"978-99969": "Oman ğŸ‡´ğŸ‡²",
"978-99970": "Haiti ğŸ‡­ğŸ‡¹",
"978-99971": "Myanmar ğŸ‡²ğŸ‡²",
"978-99972": "Faroe Islands ğŸ‡«ğŸ‡´",
"978-99973": "Mongolia ğŸ‡²ğŸ‡³",
"978-99974": "Bolivia ğŸ‡§ğŸ‡´",
"978-99975": "Tajikistan ğŸ‡¹ğŸ‡¯",
"978-99976": "Srpska, Republic of ğŸ‡·ğŸ‡¸",
"978-99977": "Rwanda ğŸ‡·ğŸ‡¼",
"978-99978": "Mongolia ğŸ‡²ğŸ‡³",
"978-99979": "Honduras ğŸ‡­ğŸ‡³",
"978-99980": "Bhutan ğŸ‡§ğŸ‡¹",
"978-99981": "Macau ğŸ‡²ğŸ‡´",
"978-99982": "Benin ğŸ‡§ğŸ‡¯",
"978-99983": "El Salvador ğŸ‡¸ğŸ‡»",
"978-99984": "Brunei Darussalam ğŸ‡§ğŸ‡³",
"978-99985": "Tajikistan ğŸ‡¹ğŸ‡¯",
"978-99986": "Myanmar ğŸ‡²ğŸ‡²",
"978-99987": "Luxembourg ğŸ‡±ğŸ‡º",
"978-99988": "Sudan ğŸ‡¸ğŸ‡©",
"978-99989": "Paraguay ğŸ‡µğŸ‡¾",
"978-99990": "Ethiopia ğŸ‡ªğŸ‡¹",
"978-99992": "Oman ğŸ‡´ğŸ‡²",
"978-99993": "Mauritius ğŸ‡²ğŸ‡º",
"979-10": "France ğŸ‡«ğŸ‡·",
"979-11": "Korea, Republic ğŸ‡°ğŸ‡·",
"979-12": "Italy ğŸ‡®ğŸ‡¹",
"979-8": "United States ğŸ‡ºğŸ‡¸"
};
        let currentISBN = '';

        // Function to draw the image on canvas
        function drawCanvas() {
            // Clear the canvas
            ctx.clearRect(0, 0, canvasWidth, canvasHeight);

            // Draw the image portion based on the current offsets
            ctx.drawImage(imageData, offsetX, offsetY, canvasWidth, canvasHeight, 0, 0, canvasWidth, canvasHeight);


        }

        // Calculate ISBN for a given pixel (x, y) with your updated formula
        function calculateISBN(x, y) {
            // Calculate the relative position in the entire image grid
            const isbnIndex = (x + (y * imageWidth)) * isbnPerPixel;

            // Ensure the ISBN starts at 978000000000
            return 978000000000 + isbnIndex;
        }

        // Match ISBN to country code based on its prefix
        function getCountryForISBN(isbn) {
            const isbnStr = isbn.toString();

            for (let prefix in countries) {
                // Remove the hyphen from the country prefix for comparison
                const cleanPrefix = prefix.replace("-", "");
                
                // Check if the ISBN starts with the cleaned-up prefix
                if (isbnStr.startsWith(cleanPrefix)) {
                    return { country: countries[prefix], prefix: cleanPrefix };  // Return country info and prefix
                }
            }
            return null; // No match found
        }

        // Helper function to pad the prefix to 12 digits
        function padToISBN(prefix, padChar) {
            const basePrefix = prefix.replace("-", ""); // Remove the hyphen
            const paddingLength = 12 - basePrefix.length; // Calculate the required padding
            return parseInt(basePrefix + padChar.repeat(paddingLength), 10); // Pad and convert to number
        }

        function highlightCountryOverlay() {
            overlayCtx.clearRect(0, 0, canvasWidth, canvasHeight); // Clear overlay canvas

            const cursorX = event.offsetX; // Mouse cursor position relative to canvas
            const cursorY = event.offsetY;

            // Map cursor position to image space
            const imageX = Math.floor((cursorX / canvasWidth) * imageWidth) + offsetX;
            const imageY = Math.floor((cursorY / canvasHeight) * imageHeight) + offsetY;

            const isbn = calculateISBN(cursorX + offsetX, cursorY + offsetY); 
            const countryData = getCountryForISBN(isbn);

            if (countryData) {
                const prefix = countryData.prefix;

                // Calculate the start and end ISBNs for the country range
                const countryStartISBN = padToISBN(prefix, "0"); // Pad with zeros for the start
                const countryEndISBN = padToISBN(prefix, "9");   // Pad with nines for the end

                // for English, let's count both ""978-0": "English language", and "978-1": "English language",\
                let countryStartRow, countryEndRow;
                if (prefix === "9780" || prefix === "9781") {
                    countryStartRow = Math.floor((padToISBN("978-0", "0") - 978000000000) / isbnPerPixel / imageWidth);
                    countryEndRow = Math.floor((padToISBN("978-1", "9") - 978000000000) / isbnPerPixel / imageWidth);
                }
                else
                {
                    countryStartRow = Math.floor((countryStartISBN - 978000000000) / isbnPerPixel / imageWidth);
                    countryEndRow = Math.floor((countryEndISBN - 978000000000) / isbnPerPixel / imageWidth);
                }
                // Directly map and clamp the range to canvas space considering offsetY
                const clampedStartRow = Math.max(
                    0,
                    Math.min(
                        canvasHeight,
                        countryStartRow - offsetY
                    )
                );

                const clampedEndRow = Math.max(
                    0,
                    Math.min(
                        canvasHeight,
                        countryEndRow - offsetY 
                    )
                );
                // Draw rectangles
                overlayCtx.globalAlpha = 0.4; // Set transparency
                height = clampedEndRow - clampedStartRow;
                // if height < 2 make it lighter or, just keep lightgray
                if (height < 2) {
                    overlayCtx.fillStyle = "yellow";
                } else {
                    overlayCtx.fillStyle = "gray";
                }
                overlayCtx.fillRect(0, clampedStartRow, canvasWidth, clampedEndRow - clampedStartRow);


                // Draw the country/language info near the mouse cursor with a highlight background
                const textWidth = countryData.country.length * 8; // Calculate text width dynamically
                overlayCtx.fillStyle = "yellow";
                //overlayCtx.fillRect(cursorX + 12, cursorY - 10, textWidth, 24); // Highlight background
                overlayCtx.fillStyle = "lightgray";
                overlayCtx.globalAlpha = 1; // Reset transparency
                overlayCtx.font = "16px Arial";
                overlayCtx.fillText(countryData.country, cursorX + 16, cursorY + 10);
            }
        }



        // Handle mouse down for dragging
        mainCanvas.addEventListener('mousedown', (e) => {
            dragging = true;
            startX = e.offsetX + offsetX;
            startY = e.offsetY + offsetY;
        });

        // Handle mouse move for dragging (move image with mouse)
        mainCanvas.addEventListener('mousemove', (e) => {
            if (dragging) {
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;

                // Move image in the same direction as the mouse movement
                offsetX = -dx;
                offsetY = -dy;

                // Boundary check to prevent going out of bounds horizontally
                if (offsetX < 0) offsetX = 0;
                if (offsetX > imageWidth - canvasWidth) offsetX = imageWidth - canvasWidth;

                // Boundary check to prevent going out of bounds vertically
                if (offsetY < 0) offsetY = 0;
                if (offsetY > imageHeight - canvasHeight) offsetY = imageHeight - canvasHeight;

                drawCanvas(); // Redraw canvas with new offsets
            }
            else
            {
                highlightCountryOverlay(e); // Highlight country zone on overlay canvas
            }
        });
        // Handle mouse up to stop dragging
        mainCanvas.addEventListener('mouseup', () => {
            dragging = false;
        });

        // Handle mouse leave to stop dragging
        mainCanvas.addEventListener('mouseleave', () => {
            dragging = false;
        });

        // Draw when the image is loaded
        imageData.onload = () => {
            drawCanvas();
        };
    </script>
</body>
</html>


